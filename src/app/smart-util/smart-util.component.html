<div style="max-width: 100vw; max-height: 80vh; overflow: hidden">
  <div
    mat-dialog-title
    class="d-flex pt-4 pt-md-0 px-4 px-md-0 justify-content-between align-items-center w-100"
  >
    <h2 class="big-design-input-title text-center">New SmartUtil</h2>
    <a role="button" (click)="close()">
      <mat-icon
        class="d-inline-flex justify-content-center align-items-center fw-bolder h-100"
        style="aspect-ratio: 1; font-size: xx-large; z-index: 50"
      >
        close
      </mat-icon>
    </a>
  </div>
  <mat-dialog-content style="overflow: hidden">
    <div style="overflow-y: scroll; height: 65vh">
      <form class="mt-3 pb-4 px-0 w-100" [formGroup]="utilForm">
        <div class="wrap-input1 w-100 pt-3 px-4 px-md-5">
          <h3 class="w-100 mb-4" style="font-size: 20px">Display Name</h3>

          <div class="rounded-pill border w-100 pb-2 px-4 mb-4">
            <mat-form-field
              class="w-100"
              appearance="legacy"
              floatLabel="never"
            >
              <input
                matInput
                class="bg-transparent text-truncate"
                type="text"
                name="name"
                formControlName="name"
                placeholder="SmartUtil Name"
              />
              <!-- <span class="shadow-input1 py-3 px-2 px-lg-4 px-md-4"></span> -->
            </mat-form-field>
          </div>
        </div>

        <div class="wrap-input1 w-100 pt-3 mb-0 px-4 px-md-5">
          <h3 class="w-100 mb-4" style="font-size: 20px">Description</h3>

          <div class="rounded-15 border w-100 pb-2 px-4 mb-4">
            <mat-form-field
              class="w-100"
              appearance="legacy"
              floatLabel="never"
            >
              <textarea
                matInput
                class="bg-transparent bg-info pb-2"
                type="text"
                name="name"
                formControlName="description"
                placeholder="SmartUtil Description"
                style="min-height: 100px"
              >
              </textarea>
              <!-- <span class="shadow-input1 py-3 px-2 px-lg-4 px-md-4"></span> -->
            </mat-form-field>
          </div>
        </div>

        <div class="wrap-input1 w-100 pt-3 mb-2 px-4 px-md-5">
          <h3 class="w-100 mb-4" style="font-size: 20px">Available Networks</h3>

          <div class="rounded-pill border w-100 pe-4 mb-3">
            <mat-form-field
              class="w-100"
              appearance="legacy"
              floatLabel="never"
            >
              <mat-select
                formControlName="networks"
                (selectionChange)="changed($event)"
                class="my-auto d-flex justify-content-start align-items-center"
                multiple
              >
                <mat-select-trigger class="text-dark h-100 m-auto bg-danger">
                  <div
                    class="w-100 d-flex justify-content-start align-items-center p-3 my-auto"
                  >
                    <!-- [mdbPopover]="template"
                    placement="bottom"
                    trigger="hover" -->
                    <div
                      class="position-relative"
                      style="width: 95px; height: 47.5px"
                      role="button"
                    >
                      <div
                        class="nft-img bg-white rounded-circle shadow d-flex justify-content-center align-items-center position-absolute"
                        style="
                          object-fit: contain;
                          aspect-ratio: 1;
                          top: 0px;
                          left: 0px;
                          overflow: hidden;
                          z-index: 50;
                        "
                      >
                        <img
                          class="m-auto rounded-circle"
                          style="object-fit: contain; height: 85%; width: 85%"
                          [src]="
                            (utilForm.controls['networks'].value ?? [])[0].url
                          "
                          role="button"
                        />
                      </div>
                      <div
                        class="nft-img bg-white rounded-circle shadow d-flex justify-content-center align-items-center position-absolute fw-bold"
                        *ngIf="
                          ((utilForm.controls['networks'].value ?? []).length ??
                            0) >
                          1
                        "
                        style="
                          object-fit: contain;
                          aspect-ratio: 1;
                          top: 0px;
                          left: 25px;
                          overflow: hidden;
                          z-index: 49;
                        "
                      >
                        <img
                          class="m-auto rounded-circle"
                          style="object-fit: contain; height: 85%; width: 85%"
                          [src]="
                            (utilForm.controls['networks'].value ?? [])[1].url
                          "
                        />
                      </div>

                      <div
                        class="nft-img bg-white rounded-circle shadow d-flex justify-content-center align-items-center position-absolute"
                        *ngIf="
                          ((utilForm.controls['networks'].value ?? []).length ??
                            0) <
                          2
                        "
                        style="
                          object-fit: contain;
                          aspect-ratio: 1;
                          top: 0px;
                          left: 25px;
                          overflow: hidden;
                          z-index: 48;
                          opacity: 0.5;
                        "
                      >
                        <!-- <img
                        class="m-auto rounded-circle bg-purple"
                        style="object-fit: contain; height: 85%; width: 85%"
                      /> -->
                        <mat-icon
                          class="m-auto rounded-circle bg-purple text-white"
                          style="object-fit: contain; height: 85%; width: 85%"
                        >
                        </mat-icon>
                      </div>

                      <div
                        class="nft-img bg-white rounded-circle shadow d-flex justify-content-center align-items-center position-absolute"
                        *ngIf="
                          ((utilForm.controls['networks'].value ?? []).length ??
                            0) >
                          2
                        "
                        style="
                          object-fit: contain;
                          aspect-ratio: 1;
                          top: 0px;
                          left: 50px;
                          overflow: hidden;
                          z-index: 48;
                          opacity: 0.5;
                        "
                      >
                        <!-- <img
                        class="m-auto rounded-circle bg-purple"
                        style="object-fit: contain; height: 85%; width: 85%"
                      /> -->
                        <mat-icon
                          class="m-auto rounded-circle bg-purple text-white"
                          style="object-fit: contain; height: 85%; width: 85%"
                        >
                        </mat-icon>
                      </div>
                    </div>
                    <span
                      class="text-start text-truncate w-50 ms-3"
                      style="font-size: large"
                    >
                      {{ chains(utilForm.controls["networks"].value ?? []) }}
                    </span>
                  </div>
                </mat-select-trigger>

                <mat-optgroup
                  *ngFor="let category of categories"
                  [label]="category.name"
                >
                  <mat-option
                    *ngFor="let chain of category.chains ?? []"
                    [value]="chain"
                  >
                    <div
                      class="h-100 w-100 d-flex justify-content-start justify-content-md-between align-items-center py-3"
                    >
                      <div
                        class="d-flex justify-content-start align-items-center"
                        style="height: 22.5px"
                      >
                        <img
                          id="image"
                          *ngIf="chain?.url"
                          class="me-2 h-100"
                          [src]="chain?.url"
                          style="object-fit: cover; aspect-ratio: 1"
                        />
                        <span class="py-1" style="font-size: medium">
                          {{ chain?.name ?? "No Network Selected" }}
                        </span>
                      </div>
                      <div class="h-100 p-3">
                        <div
                          class="bg-white border rounded-circle p-1"
                          style="height: 22.5px; aspect-ratio: 1"
                        >
                          <div
                            class="border rounded-circle bg-{{
                              contains(chain) ? 'purple' : 'light'
                            }}"
                            style="aspect-ratio: 1"
                          ></div>
                        </div>
                      </div>
                    </div>
                  </mat-option>
                </mat-optgroup>
              </mat-select>
            </mat-form-field>
          </div>
        </div>

        <div class="w-100 py-5 text-purple text-center fw-bold">
          <i><span style="font-size: small">Basic</span></i>
          <hr class="fw-bolder border-1" />
        </div>

        <div class="wrap-input1 w-100 pt-3 px-4 px-md-5">
          <h3 class="w-100 mb-4" style="font-size: 20px">Install Webhook</h3>

          <div
            class="rounded-pill border w-100 px-4 pe-0 mb-4 d-flex justify-content-between align-content-center"
          >
            <mat-form-field
              class="mb-0 pe-3 w-75"
              appearance="legacy"
              floatLabel="never"
            >
              <input
                matInput
                class="mb-2 text-truncate"
                type="text"
                name="name"
                formControlName="installWebhook"
                placeholder="Enter Webhook URL"
              />
            </mat-form-field>
            <div
              class="bg-white rounded-circle shadow p-1"
              style="height: 52.5px !important; width: 52.5px !important"
              role="button"
              [mdbPopover]="webhook1Template"
              placement="top"
              [trigger]="'hover'"
            >
              <div
                class="bg-purple m-auto rounded-circle d-flex justify-content-center align-content-center notif-icon success-hover"
                style="aspect-ratio: 1"
              >
                <mat-icon class="text-white m-auto" style="font-size: 25px">
                  smart_toy
                </mat-icon>
              </div>
            </div>
            <ng-template #webhook1Template>
              <div class="popover-body-padding">
                <b class="fw-bolder mb-4 text-light-success"
                  >Fired when SmartUtil installed</b
                >
                <br />
                Press me to send a sample payload to your webhook!
              </div>
            </ng-template>
          </div>
        </div>

        <div class="wrap-input1 w-100 pt-3 px-4 px-md-5">
          <h3 class="w-100 mb-4" style="font-size: 20px">Uninstall Webhook</h3>

          <div
            class="rounded-pill border w-100 px-4 pe-0 mb-4 d-flex justify-content-between align-content-center"
          >
            <mat-form-field
              class="mb-0 pe-3 w-75"
              appearance="legacy"
              floatLabel="never"
            >
              <input
                matInput
                class="mb-2 text-truncate"
                type="text"
                name="name"
                formControlName="uninstallWebhook"
                placeholder="Enter Webhook URL"
              />
            </mat-form-field>
            <div
              class="bg-white rounded-circle shadow p-1"
              style="height: 52.5px !important; width: 52.5px !important"
              role="button"
              [mdbPopover]="webhook2Template"
              placement="top"
              [trigger]="'hover'"
            >
              <div
                class="bg-purple m-auto rounded-circle d-flex justify-content-center align-content-center notif-icon danger-hover"
                style="aspect-ratio: 1"
              >
                <mat-icon class="text-white m-auto" style="font-size: 25px">
                  smart_toy
                </mat-icon>
              </div>
            </div>
            <ng-template #webhook2Template>
              <div class="popover-body-padding">
                <b class="fw-bolder mb-4 text-danger"
                  >Fired when SmartUtil uninstalled</b
                >
                <br />
                Press me to send a sample payload to your webhook!
              </div>
            </ng-template>
          </div>
        </div>

        <div class="w-100 py-5 text-purple text-center fw-bold">
          <i><span style="font-size: small">Technical</span></i>
          <hr class="fw-bolder border-1" />
        </div>

        <div class="wrap-input1 w-100 pt-3 px-4 px-md-5">
          <h3 class="w-100 mb-4" style="font-size: 20px">Listing Price</h3>

          <div
            class="rounded-pill border w-100 px-4 pe-0 mb-4 d-flex justify-content-between align-content-center"
          >
            <mat-form-field
              class="mb-0 pe-3 w-75"
              appearance="legacy"
              floatLabel="never"
            >
              <input
                matInput
                currencyMask
                [options]="customCurrencyMaskConfig"
                class="mb-2 text-truncate"
                type="text"
                name="name"
                formControlName="price"
                placeholder="Price"
              />
            </mat-form-field>
            <div
              class="bg-white rounded-circle shadow p-1"
              style="height: 52.5px !important; width: 52.5px !important"
              role="button"
              [mdbPopover]="template"
              placement="top"
              [trigger]="'hover'"
            >
              <div
                class="bg-purple m-auto rounded-circle d-flex justify-content-center align-content-center notif-icon success-hover"
                style="aspect-ratio: 1"
              >
                <mat-icon class="text-white m-auto" style="font-size: 25px">
                  smart_toy
                </mat-icon>
              </div>
            </div>
            <ng-template #template>
              <div class="popover-body-padding">
                <b class="fw-bolder mb-4 text-light-success">Relative Prices</b>
                <br />
                Prices are relative to the different networks. Ex. 100 ETH, 100
                MATIC.
              </div>
            </ng-template>
          </div>
        </div>

        <div class="wrap-input1 w-100 pt-3 px-4 px-md-5">
          <h3 class="w-100 mb-4" style="font-size: 20px">Sale Address</h3>

          <div class="rounded-pill border w-100 pb-2 px-4 mb-4">
            <mat-form-field
              class="w-100"
              appearance="legacy"
              floatLabel="never"
            >
              <input
                matInput
                class="bg-transparent text-truncate"
                type="text"
                name="name"
                formControlName="wallet"
                placeholder="Payout Address"
              />
              <!-- <span class="shadow-input1 py-3 px-2 px-lg-4 px-md-4"></span> -->
            </mat-form-field>
          </div>
        </div>

        <div class="w-100 py-5 text-purple text-center fw-bold">
          <i><span style="font-size: small">Financial</span></i>
          <hr class="fw-bolder border-1" />
        </div>

        <div class="wrap-input1 w-100 pt-3 mb-4 px-4 px-md-5">
          <h3 class="w-100 mb-4" style="font-size: 20px">Display Images</h3>

          <div class="rounded-15 border w-100" style="aspect-ratio: 1.5">
            <div
              class="position-relative w-100 h-100 animate__animated animate__fadeIn zoom"
            >
              <div
                class="m-img-input position-relative h-100 w-100 bg-purple rounded-15 shadow d-flex justify-content-center align-content-center"
                role="button"
                (click)="marketingImgInput.click()"
              >
                <img
                  class="h-100 w-100 m-img-input-display"
                  style="object-fit: cover"
                  [src]="utilForm.controls['marketingImg'].value | safeUrl"
                  role="button"
                />
                <input
                  #marketingImgInput
                  type="file"
                  (change)="fileChangeEvent($event, 0)"
                  style="display: none"
                />
                <mat-icon
                  class="text-white shadow fw-bolder position-absolute"
                  style="z-index: 48; top: 50%"
                  >upload
                </mat-icon>
              </div>

              <div
                class="position-absolute w-md-auto bg-white rounded-icon shadow d-flex justify-content-center align-items-center"
                style="
                  object-fit: contain;
                  aspect-ratio: 1;
                  height: 20%;
                  bottom: 10px;
                  right: 10px;
                  overflow: hidden;
                "
              >
                <div
                  class="m-auto position-relative img-input"
                  style="height: 90%; width: 90%; overflow: hidden"
                  role="button"
                  (click)="appImgInput.click()"
                >
                  <img
                    class="w-100 h-100 position-absolute"
                    style="z-index: 50; object-fit: contain"
                    [src]="utilForm.controls['appImg'].value | safeUrl"
                  />
                  <div
                    class="w-100 h-100 position-absolute img-input-display bg-purple text-white"
                    style="z-index: 51; opacity: 0.5"
                  >
                    <mat-icon class="m-auto">upload </mat-icon>
                  </div>
                  <input
                    #appImgInput
                    type="file"
                    (change)="fileChangeEvent($event, 1)"
                    style="display: none"
                  />
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="w-100 py-5 text-purple text-center fw-bold">
          <i><span style="font-size: small">Marketing</span></i>
          <hr class="fw-bolder border-1" />
        </div>

        <div class="wrap-input1 w-100 pt-0 px-4 px-md-5">
          <button
            class="px-3 py-3 w-100 btn bg-purple text-white fw-bolder rounded-pill"
            (click)="save()"
            [disabled]="loading"
          >
            {{loading ? "Saving" : "Save SmartUtil"}}
            <span
            *ngIf="loading"
            class="spinner-border spinner-border-sm ms-1"
            role="status"
            aria-hidden="true"
          ></span>
          </button>
        </div>
      </form>
      <!-- <p *ngIf="err != ''" class="text-danger my-1 text-center fw-bold">
          {{ err }}
        </p> -->
    </div>
  </mat-dialog-content>
</div>
